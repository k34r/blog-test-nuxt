import{m as P,u as L,r as m,n as S,p as M,q as D,c as r,o as d,a as s,s as p,v as f,x as $,y as B,F as v,z as E,A as g,t as h,B as w}from"./Bn0b61HB.js";import{u as O}from"./CymKluOc.js";const V={class:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-2"},T=["onClick"],U={class:"text-xl font-semibold"},j={class:"text-gray-500"},A={class:"mt-4 flex gap-4"},F=["onClick"],H=["onClick"],N={key:0,class:"text-center text-gray-500 py-4"},q={key:1,class:"text-center mt-4 text-gray-500"},Y=P({__name:"index",setup(z){const n=O(),i=L(),l=m(""),a=m("desc");S(async()=>{await n.fetchPosts(),window.addEventListener("scroll",c)}),M(()=>{window.removeEventListener("scroll",c)});const x=D(()=>n.posts.filter(e=>e.title.toLowerCase().includes(l.value.toLowerCase()))),_=e=>{i.push(`/post/${e}`)},y=e=>{i.push(`/post/edit${e}`)},b=()=>{n.changeSortOrder(a.value)},k=async e=>{confirm("Вы уверены, что хотите удалить этот пост?")&&await n.deletePost(e)},C=e=>{let t;if(typeof e=="string")t=new Date(e);else if(e&&e.seconds)t=new Date(e.seconds*1e3);else return"Неизвестная дата";return t.toLocaleString()},c=()=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-100&&!n.isLoading&&n.hasMore&&n.loadMorePosts()};return(e,t)=>(d(),r(v,null,[s("div",V,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),type:"text",placeholder:"Поиск по заголовку",class:"w-full md:w-1/3 p-2 border rounded-md"},null,512),[[$,l.value]]),f(s("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value=o),onChange:b,class:"w-full md:w-1/3 p-2 border rounded-md"},t[2]||(t[2]=[s("option",{value:"desc"},"Сначала новые",-1),s("option",{value:"asc"},"Сначала старые",-1)]),544),[[B,a.value]])]),(d(!0),r(v,null,E(x.value,o=>(d(),r("div",{key:o.id,onClick:u=>_(o.id),class:"post-card p-4 mb-4 border rounded-lg shadow-md cursor-pointer"},[s("h2",U,h(o.title),1),s("small",j,h(C(o.createdAt)),1),s("div",A,[s("button",{onClick:w(u=>y(o.id),["stop"]),class:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"}," Редактировать ",8,F),s("button",{onClick:w(u=>k(o.id),["stop"]),class:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600"}," Удалить ",8,H)])],8,T))),128)),g(n).isLoading?(d(),r("div",N,"Загрузка...")):p("",!0),g(n).hasMore?p("",!0):(d(),r("div",q," Больше постов нет "))],64))}});export{Y as default};
